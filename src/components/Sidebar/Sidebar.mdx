import { Meta, Subtitle, Title, ArgTypes } from '@storybook/blocks';
import { CollapsibleCanvas, CollapsibleSource } from '@storybookComponents/CollapsibleCanvas';
import { linkTo } from '@storybook/addon-links';
import { Hero } from '@storybookComponents/Hero';

import * as SidebarStories from './Sidebar.stories';
import { Sidebar, SidebarProvider, SidebarMenuButton } from "./Sidebar";

<Meta of={SidebarStories} />

<Title>Sidebar</Title>
<Subtitle>Composable navigation sidebar for application layouts</Subtitle>

<Hero className="block w-full max-w-lg text-center">
  {/* Visual representation of Sidebar would go here, matching Hero standard */}
</Hero>

## Usage

```jsx
import {
  SidebarProvider,
  Sidebar,
  SidebarHeader,
  SidebarContent,
  SidebarFooter,
  SidebarMenu,
  SidebarMenuItem,
  SidebarMenuButton,
  SidebarTrigger,
} from "@plexui/ui/components/Sidebar";
```

<CollapsibleCanvas of={SidebarStories.Base} additionalActions={[
  { title: 'View story', onClick: linkTo(SidebarStories.default.title, 'Base')}
]} />
<CollapsibleSource of={SidebarStories.Base} />

## Reference

<h3 id="sidebar-provider" data-heading-label="Provider">`SidebarProvider`</h3>

The `SidebarProvider` manages the sidebar state and must wrap all sidebar components. It supports both controlled and uncontrolled modes.

<ArgTypes of={SidebarProvider} />

<h3 id="sidebar-root" data-heading-label="Root">`Sidebar`</h3>

The main container for the sidebar content.

<ArgTypes of={Sidebar} />

<h3 id="sidebar-menu-button" data-heading-label="MenuButton">`SidebarMenuButton`</h3>

Clickable navigation item that handles labels and icons.

<ArgTypes of={SidebarMenuButton} />

### Hook: `useSidebar`

Access sidebar state anywhere within the provider:

```jsx
const { open, state, isMobile, toggleSidebar } = useSidebar();
```

| Property | Type | Description |
|----------|------|-------------|
| `open` | `boolean` | Current open state |
| `state` | `"expanded" \| "collapsed"` | Derived state string |
| `openMobile` | `boolean` | Mobile drawer open state |
| `isMobile` | `boolean` | Whether viewport is mobile |
| `collapsible` | `"offcanvas" \| "icon" \| "none"` | Current collapsible mode |
| `toggleSidebar` | `() => void` | Toggle function |
| `setOpen` | `(open: boolean) => void` | Set open state |
| `setOpenMobile` | `(open: boolean) => void` | Set mobile open state |

## Examples

### Collapsibility

The sidebar supports different collapse behaviors to fit various application needs.

- **offcanvas** (default): On mobile, works as a drawer. On desktop, collapses completely.
- **icon**: Collapses to an icon-only rail.
- **none**: Static sidebar that cannot be collapsed.

<CollapsibleCanvas of={SidebarStories.CollapsibleIcon} />

### Variants

Use the `variant` prop to change the visual appearance of the sidebar for different contexts.

<CollapsibleCanvas of={SidebarStories.DualTier} />

### Mobile Support

Mobile behavior is handled automatically when using `SidebarProvider`. The `SidebarMobileMenuButton` provides a standard animated hamburger trigger.

<CollapsibleCanvas of={SidebarStories.Mobile} />

### Search & Skeleton

The sidebar provides dedicated components for common patterns like search inputs and loading states.

<CollapsibleCanvas of={SidebarStories.WithSearch} />
<CollapsibleCanvas of={SidebarStories.LoadingSkeleton} />

## Keyboard Shortcuts

| Shortcut | Action |
|----------|--------|
| `Cmd/Ctrl + B` | Toggle sidebar open/closed |
| `Escape` | Close mobile drawer |

Shortcuts are disabled when `collapsible="none"`.

## Accessibility

The sidebar follows WAI-ARIA patterns for navigation landmarks and focus management:

- Keyboard navigation with `Tab` and `Enter`.
- `aria-label` on trigger buttons.
- Focus trap in mobile/offcanvas modes.
- Screen reader announcements for state changes.
